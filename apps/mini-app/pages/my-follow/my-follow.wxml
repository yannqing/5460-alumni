<!--pages/my-follow/my-follow.wxml-->
<!-- è‡ªå®šä¹‰å¯¼èˆªæ  -->
<custom-nav-bar title="æˆ‘çš„å…³æ³¨" showBack="{{true}}"></custom-nav-bar>

<!-- æ¶ˆæ¯é€šçŸ¥ç»„ä»¶ -->
<message-notification />

<view class="follow-page">
  <!-- é¡¶éƒ¨Tabæ  -->
  <view class="tab-bar">
    <view class="tab-item {{currentTab === 'follow' ? 'active' : ''}}" bindtap="switchTab" data-tab="follow">
      æˆ‘çš„å…³æ³¨
    </view>
    <view class="tab-item {{currentTab === 'fans' ? 'active' : ''}}" bindtap="switchTab" data-tab="fans">
      æˆ‘çš„ç²‰ä¸
    </view>
    <view class="tab-item {{currentTab === 'friend' ? 'active' : ''}}" bindtap="switchTab" data-tab="friend">
      å¥½å‹
    </view>
  </view>

  <!-- ç±»å‹ç­›é€‰ï¼ˆå¥½å‹tabä¸æ˜¾ç¤ºç±»å‹ç­›é€‰ï¼‰ -->
  <scroll-view class="type-scroll" scroll-x="{{true}}" enable-flex="{{true}}" wx:if="{{currentTab !== 'friend'}}">
    <view class="type-tabs">
      <view
        class="type-tab {{activeType === '' ? 'active' : ''}}"
        bindtap="selectType"
        data-type="">
        å…¨éƒ¨
      </view>
      <view
        class="type-tab {{activeType === 'user' ? 'active' : ''}}"
        bindtap="selectType"
        data-type="user">
        ç”¨æˆ·
      </view>
      <view
        class="type-tab {{activeType === 'association' ? 'active' : ''}}"
        bindtap="selectType"
        data-type="association">
        æ ¡å‹ä¼š
      </view>
      <view
        class="type-tab {{activeType === 'school' ? 'active' : ''}}"
        bindtap="selectType"
        data-type="school">
        æ¯æ ¡
      </view>
      <view
        class="type-tab {{activeType === 'merchant' ? 'active' : ''}}"
        bindtap="selectType"
        data-type="merchant">
        å•†é“º
      </view>
    </view>
  </scroll-view>

  <!-- åˆ—è¡¨å†…å®¹ -->
  <scroll-view class="list-scroll" scroll-y="{{true}}" bindscrolltolower="loadMore">
    <view class="list">
      <!-- ç»Ÿä¸€å¡ç‰‡æ ¼å¼ -->
      <block wx:for="{{list}}" wx:key="id">
        <view class="follow-item-card" bindtap="viewDetail" data-item="{{item}}">
          <image class="item-avatar" src="{{item.targetAvatar}}" mode="aspectFill" />
          <view class="item-content">
            <view class="item-name">{{item.targetName}}</view>
            <view class="item-description" wx:if="{{item.targetDescription}}">{{item.targetDescription}}</view>
            <view class="follow-time">å…³æ³¨æ—¶é—´ï¼š{{item.followTime}}</view>
          </view>
          <view class="follow-status" wx:if="{{currentTab === 'follow'}}" catchtap="updateFollowStatus" data-item="{{item}}">
            <text class="status-text">{{item.followStatusText}}</text>
          </view>
          <view class="follow-status" wx:else>
            <text class="status-text-readonly">{{item.followStatusText}}</text>
          </view>
        </view>
      </block>
    </view>

    <!-- åŠ è½½çŠ¶æ€ -->
    <view wx:if="{{loading}}" class="loading-state">åŠ è½½ä¸­...</view>

    <!-- ç©ºçŠ¶æ€ -->
    <view wx:if="{{!loading && list.length === 0}}" class="empty-state">
      <view class="empty-icon">ğŸ’­</view>
      <text class="empty-text">
        {{currentTab === 'follow' ? 'æš‚æ— å…³æ³¨' : currentTab === 'fans' ? 'æš‚æ— ç²‰ä¸' : 'æš‚æ— å¥½å‹'}}
      </text>
    </view>

    <!-- æ²¡æœ‰æ›´å¤š -->
    <view wx:if="{{!loading && list.length > 0 && !hasMore}}" class="no-more">æ²¡æœ‰æ›´å¤šäº†</view>
  </scroll-view>
</view>
