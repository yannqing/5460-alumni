<!--pages/search/search.wxml-->
<view class="container">
  <!-- æœç´¢æ¡† -->
  <view class="search-bar">
    <view class="search-input-wrap">
      <input class="search-input" type="text" placeholder="æœç´¢æ¯æ ¡ã€æ ¡å‹ä¼šã€æ ¡å‹" value="{{keyword}}" bindinput="onSearchInput" bindconfirm="onSearch" focus />
      <view class="search-actions">
        <image class="scan-btn-icon" src="{{iconScan}}" mode="aspectFit" bindtap="scanCode" />
        <image class="search-btn" src="{{iconSearch}}" mode="aspectFit" bindtap="onSearch" />
      </view>
    </view>
  </view>

  <!-- æœç´¢å‰æ˜¾ç¤º -->
  <view wx:if="{{!showResult}}">
    <!-- çƒ­é—¨æœç´¢ -->
    <view class="section card">
      <view class="section-title-small">çƒ­é—¨æœç´¢</view>
      <view class="tag-list">
        <view class="tag" wx:for="{{hotSearchList}}" wx:key="*this" bindtap="onHotSearchTap" data-keyword="{{item}}">
          {{item}}
        </view>
      </view>
    </view>

    <!-- æœç´¢å†å² -->
    <view wx:if="{{searchHistory.length > 0}}" class="section card">
      <view class="flex-between mb-20">
        <view class="section-title-small">æœç´¢å†å²</view>
        <view class="text-placeholder" bindtap="clearHistory">æ¸…ç©º</view>
      </view>
      <view class="history-list">
        <view class="history-item" wx:for="{{searchHistory}}" wx:key="*this" bindtap="onHistoryTap" data-keyword="{{item}}">
          <text class="history-icon">ğŸ•</text>
          <text class="history-text">{{item}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- æœç´¢ç»“æœ -->
  <view wx:else>
    <view class="tabs">
      <view class="tab-item {{activeTab === index ? 'active' : ''}}" wx:for="{{tabs}}" wx:key="*this" bindtap="switchTab" data-index="{{index}}">
        {{item}}
      </view>
    </view>

    <!-- å…¨éƒ¨ç»“æœ -->
    <view wx:if="{{activeTab === 0}}">
      <view wx:if="{{searchResult.schools.length > 0}}" class="result-section">
        <view class="section-title-small">æ¯æ ¡</view>
        <view class="list-item" wx:for="{{searchResult.schools}}" wx:key="id" bindtap="viewSchoolDetail" data-id="{{item.id}}">
          <image class="avatar" src="{{item.icon}}" mode="aspectFill" />
          <view class="flex-1">
            <view class="text-primary text-bold">{{item.name}}</view>
            <view class="text-placeholder mt-10">{{item.location}} Â· {{item.alumniCount}}äºº</view>
          </view>
        </view>
      </view>

      <view wx:if="{{searchResult.associations.length > 0}}" class="result-section">
        <view class="section-title-small">æ ¡å‹ä¼š</view>
        <view class="list-item" wx:for="{{searchResult.associations}}" wx:key="id" bindtap="viewAssociationDetail" data-id="{{item.id}}">
          <view class="flex-1">
            <view class="text-primary text-bold">{{item.name}}</view>
            <view class="text-placeholder mt-10">{{item.location}} Â· {{item.memberCount}}äºº</view>
          </view>
        </view>
      </view>

      <view wx:if="{{searchResult.alumni.length > 0}}" class="result-section">
        <view class="section-title-small">æ ¡å‹</view>
        <view class="list-item" wx:for="{{searchResult.alumni}}" wx:key="id" bindtap="viewAlumniDetail" data-id="{{item.id}}">
          <image class="avatar" src="{{item.avatar}}" mode="aspectFill" />
          <view class="flex-1">
            <view class="text-primary text-bold">{{item.name}}</view>
            <view class="text-placeholder mt-10">{{item.school}} Â· {{item.company}}</view>
          </view>
        </view>
      </view>
    </view>
  </view>
</view>
