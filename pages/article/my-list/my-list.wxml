<!-- 消息通知组件 -->
<message-notification />

<view class="container">
  <!-- 状态标签页 -->
  <view class="status-tabs">
    <view 
      class="status-tab {{activeStatus === item.value ? 'active' : ''}}"
      wx:for="{{statusTabs}}"
      wx:key="value"
      data-status="{{item.value}}"
      bindtap="switchStatus"
    >
      <text>{{item.label}}</text>
    </view>
  </view>

  <view class="article-list">
    <block wx:for="{{articles}}" wx:key="id" wx:for-index="idx">
      <view class="article-card">
        <view bindtap="goToDetail" data-id="{{item.id}}" data-index="{{idx}}">
          <!-- 头部：用户信息 -->
          <view class="card-header">
            <view class="user-avatar-wrapper">
              <image class="user-avatar" src="{{item.avatar}}" mode="aspectFill" wx:if="{{item.avatar}}"></image>
            </view>
            <view class="user-info">
              <view class="user-name-row">
                <text class="user-name">{{item.publisher}}</text>
                <!-- 状态标签：显示在用户名称右侧 -->
                <text class="article-tag status-tag status-{{item.articleStatus}}" wx:if="{{item.articleStatus !== undefined && item.articleStatus !== null}}">
                  {{item.articleStatus === -1 ? '待审核' : (item.articleStatus === 1 ? '已通过' : '已拒绝')}}
                </text>
              </view>
              <text class="publish-time">{{item.time}}</text>
            </view>
          </view>

          <!-- 内容区域：根据是否有图决定布局 -->
          <view class="card-body has-cover">
            <view class="text-content">
              <view class="article-title">{{item.title}}</view>
              <view class="article-desc" wx:if="{{item.description}}">{{item.description}}</view>
            </view>
            
            <!-- 右侧封面图：始终显示图片框 -->
            <view class="article-cover-wrapper">
              <image class="article-cover" src="{{item.cover}}" mode="aspectFill" wx:if="{{item.cover}}"></image>
            </view>
          </view>
          
          <!-- 底部状态栏 -->
          <view class="card-footer" wx:if="{{item.isTop}}">
            <text class="article-tag">置顶</text>
          </view>
        </view>
        
        <!-- 操作按钮 -->
        <view class="card-actions">
          <view class="action-btn edit-btn" bindtap="goToEdit" data-id="{{item.id}}" data-index="{{idx}}">编辑</view>
        </view>
      </view>
    </block>

    <view class="empty-state" wx:if="{{!loading && articles.length === 0}}">
      <image class="empty-img" src="/assets/images/empty.png" mode="widthFix" wx:if="{{false}}"></image>
      <text>暂无文章</text>
    </view>
    <view class="loading-state" wx:if="{{loading}}">
      <text>加载中...</text>
    </view>
    <view class="no-more-state" wx:if="{{!hasMore && articles.length > 0}}">
      <text>没有更多了</text>
    </view>
  </view>

  <view class="footer-btn-wrapper">
    <button class="add-btn" bindtap="goToAdd">新增文章</button>
  </view>
</view>