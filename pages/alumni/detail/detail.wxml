<!-- 自定义导航栏包裹器 -->
<custom-nav-bar showBack="{{true}}" useAuditStyle="{{true}}" auditTitle="校友详情">
  <!-- 消息通知组件 -->
  <message-notification />

  <view class="alumni-detail-page">
    <view wx:if="{{alumniInfo}}">
      <!-- 背景和头像区域 -->
      <view class="profile-header">
        <image wx:if="{{alumniInfo.bgImg}}" class="background-image" src="{{alumniInfo.bgImg}}" mode="aspectFill"></image>
        <view wx:else class="default-bg-gradient"></view>
        <view class="header-overlay"></view>
        
        <view class="profile-main-content">
          <view class="profile-left-section">
            <view class="avatar-nickname-row">
              <image class="avatar-circle" src="{{alumniInfo.avatarUrl}}" mode="aspectFill"></image>
              <view class="name-area">
                <view class="nickname-wrap">
                  <view class="nickname-text">{{alumniInfo.nickname.value}}</view>
                  <view class="certification-badge" wx:if="{{alumniInfo.isAlumni}}">
                    <text class="badge-text">校友会认证</text>
                  </view>
                </view>
                <view class="signature-text {{alumniInfo.signature.isNull ? 'text-null' : ''}}">{{alumniInfo.signature.value}}</view>
              </view>
            </view>
            
            <view class="quick-info-row">
              <text class="quick-info-item {{alumniInfo.gender.isNull ? 'text-null' : ''}}">{{alumniInfo.gender.value}}</text>
              <text class="quick-info-divider"></text>
              <text class="quick-info-item {{alumniInfo.age.isNull ? 'text-null' : ''}}">{{alumniInfo.age.value}}</text>
              <text class="quick-info-divider"></text>
              <text class="quick-info-item {{alumniInfo.zodiac.isNull ? 'text-null' : ''}}">{{alumniInfo.zodiac.value}}</text>
            </view>
          </view>
          
          <view class="profile-right-section">
            <view class="action-btn message-btn" bindtap="goToChat">私信</view>
            <view class="action-btn follow-btn {{alumniInfo.isFollowed ? 'followed' : ''}}" bindtap="toggleFollow">
              {{alumniInfo.isFriend ? '互相关注' : (alumniInfo.isFollowed ? '已关注' : '关注TA')}}
            </view>
          </view>
        </view>
      </view>

      <!-- 核心信息卡片 -->
      <view class="info-sections">
        
        <!-- 基本资料 -->
        <view class="info-card">
          <view class="card-header">
            <view class="card-title">基本资料</view>
          </view>
          <view class="card-content">
            <view class="info-item">
              <view class="info-label">真实姓名</view>
              <view class="info-value {{alumniInfo.name.isNull ? 'text-null' : ''}}">{{alumniInfo.name.value}}</view>
            </view>
            <view class="info-item">
              <view class="info-label">性别</view>
              <view class="info-value {{alumniInfo.gender.isNull ? 'text-null' : ''}}">{{alumniInfo.gender.value}}</view>
            </view>
            <view class="info-item">
              <view class="info-label">出生日期</view>
              <view class="info-value {{alumniInfo.birthDate.isNull ? 'text-null' : ''}}">{{alumniInfo.birthDate.value}}</view>
            </view>
            <view class="info-item">
              <view class="info-label">星座</view>
              <view class="info-value {{alumniInfo.constellation.isNull ? 'text-null' : ''}}">{{alumniInfo.constellation.value}}</view>
            </view>
            <view class="info-item">
              <view class="info-label">婚姻状态</view>
              <view class="info-value {{alumniInfo.maritalStatus.isNull ? 'text-null' : ''}}">{{alumniInfo.maritalStatus.value}}</view>
            </view>
            <view class="info-item">
              <view class="info-label">个人特长</view>
              <view class="info-value {{alumniInfo.personalSpecialty.isNull ? 'text-null' : ''}}">{{alumniInfo.personalSpecialty.value}}</view>
            </view>
          </view>
        </view>

        <!-- 联系方式 -->
        <view class="info-card">
          <view class="card-header">
            <view class="card-title">联系方式</view>
          </view>
          <view class="card-content">
            <view class="info-item">
              <view class="info-label">手机号</view>
              <view class="info-value {{alumniInfo.phone.isNull ? 'text-null' : ''}}">{{alumniInfo.phone.value}}</view>
            </view>
            <view class="info-item">
              <view class="info-label">微信号</view>
              <view class="info-value {{alumniInfo.wxNum.isNull ? 'text-null' : ''}}">{{alumniInfo.wxNum.value}}</view>
            </view>
            <view class="info-item">
              <view class="info-label">QQ号</view>
              <view class="info-value {{alumniInfo.qqNum.isNull ? 'text-null' : ''}}">{{alumniInfo.qqNum.value}}</view>
            </view>
            <view class="info-item">
              <view class="info-label">电子邮箱</view>
              <view class="info-value {{alumniInfo.email.isNull ? 'text-null' : ''}}">{{alumniInfo.email.value}}</view>
            </view>
          </view>
        </view>

        <!-- 位置信息 -->
        <view class="info-card">
          <view class="card-header">
            <view class="card-title">位置信息</view>
          </view>
          <view class="card-content">
            <view class="info-item">
              <view class="info-label">籍贯</view>
              <view class="info-value {{alumniInfo.originProvince.isNull ? 'text-null' : ''}}">{{alumniInfo.originProvince.value}}</view>
            </view>
            <view class="info-item">
              <view class="info-label">常驻地区</view>
              <view class="info-value {{alumniInfo.curProvince.isNull && alumniInfo.curCity.isNull ? 'text-null' : ''}}">
                {{alumniInfo.curProvince.isNull ? '' : alumniInfo.curProvince.value}}{{alumniInfo.curCity.isNull ? '' : alumniInfo.curCity.value}}{{alumniInfo.curCounty.isNull ? '' : alumniInfo.curCounty.value}}
                <block wx:if="{{alumniInfo.curProvince.isNull && alumniInfo.curCity.isNull && alumniInfo.curCounty.isNull}}">不方便透露</block>
              </view>
            </view>
            <view class="info-item">
              <view class="info-label">详细地址</view>
              <view class="info-value {{alumniInfo.address.isNull ? 'text-null' : ''}}">{{alumniInfo.address.value}}</view>
            </view>
          </view>
        </view>

        <!-- 学习经历 -->
        <view class="info-card" wx:if="{{alumniInfo.educationList}}">
          <view class="card-header">
            <view class="card-title">教育背景</view>
          </view>
          <view class="card-content">
            <view class="history-item" wx:for="{{alumniInfo.educationList}}" wx:key="index">
              <view class="history-header">
                <view class="history-title">{{item.schoolName}}</view>
                <view class="history-tag">{{item.type}}</view>
              </view>
              <view class="history-meta">
                <block wx:if="{{item.enrollmentYear || item.graduationYear}}">
                  {{item.enrollmentYear || '?'}} - {{item.graduationYear || '?'}}
                </block>
                <block wx:if="{{(item.enrollmentYear || item.graduationYear) && item.educationLevel}}"> · </block>
                <block wx:if="{{item.educationLevel}}">{{item.educationLevel}}</block>
              </view>
              <view class="history-detail">
                <block wx:if="{{item.department}}">{{item.department}}</block>
                <block wx:if="{{item.department && item.major}}"> · </block>
                <block wx:if="{{item.major}}">{{item.major}}</block>
                <block wx:if="{{(item.department || item.major) && item.className}}"> · </block>
                <block wx:if="{{item.className}}">{{item.className}}</block>
              </view>
            </view>
          </view>
        </view>

        <!-- 工作经历 -->
        <view class="info-card" wx:if="{{alumniInfo.workExperienceList}}">
          <view class="card-header">
            <view class="card-title">工作经历</view>
          </view>
          <view class="card-content">
            <view class="history-item" wx:for="{{alumniInfo.workExperienceList}}" wx:key="index">
              <view class="history-header">
                <view class="history-title">{{item.companyName}}</view>
                <view class="history-tag active" wx:if="{{item.isCurrent}}">在职</view>
              </view>
              <view class="history-meta">
                <block wx:if="{{item.startDate || item.endDate}}">
                  {{item.startDate || '?'}} - {{item.endDate || '?'}}
                </block>
                <block wx:if="{{(item.startDate || item.endDate) && item.industry}}"> · </block>
                <block wx:if="{{item.industry}}">{{item.industry}}</block>
              </view>
              <view class="history-detail">{{item.position}}</view>
              <view class="history-desc" wx:if="{{item.workDescription}}">{{item.workDescription}}</view>
            </view>
          </view>
        </view>

        <!-- 个人简介 -->
        <view class="info-card">
          <view class="card-header">
            <view class="card-title">个人简介</view>
          </view>
          <view class="card-content">
            <view class="bio-text {{alumniInfo.description.isNull ? 'text-null' : ''}}">
              {{alumniInfo.description.value}}
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>
</custom-nav-bar>
