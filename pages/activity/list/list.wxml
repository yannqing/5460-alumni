<!--pages/activity/list/list.wxml-->
<custom-nav-bar showBack="{{true}}" useAuditStyle="{{true}}" auditTitle="æ´»åŠ¨ç®¡ç†">
<message-notification />

<view class="page">
  <!-- æ ¡å‹ä¼šé€‰æ‹©å¡ç‰‡ï¼ˆä¸æˆå‘˜ç®¡ç†/æ¶æ„ç®¡ç†ä¸€è‡´ï¼Œå›ºå®šä¸æ»šåŠ¨ï¼‰ -->
  <view class="group_5" wx:if="{{!hasSingleAlumniAssociation && hasAlumniAdminPermission}}">
    <text class="text_14">æ ¡å‹æ´»åŠ¨</text>
    <text class="label_text">é€‰æ‹©æ ¡å‹ä¼š</text>
    <view class="text-wrapper_8" bindtap="showAlumniAssociationSelector">
      <text class="text_15">{{selectedAlumniAssociationName || 'è¯·é€‰æ‹©æ ¡å‹ä¼š'}}</text>
    </view>
  </view>

  <!-- æ´»åŠ¨åˆ—è¡¨å¡ç‰‡ï¼ˆä¸å®¡æ ¸åˆ—è¡¨ä¸€è‡´ï¼šå›ºå®šæ ‡é¢˜+ç­›é€‰ï¼Œä»…å†…éƒ¨æ»šåŠ¨ï¼‰ -->
  <view class="group_7">
    <view class="activity-list-header">
      <view class="header-left">
        <text class="header-title">æ ¡å‹æ´»åŠ¨</text>
        <text class="header-subtitle">ä¸€èµ·é“¾æ¥æ›´æœ‰èƒ½é‡çš„åŒä¼´</text>
      </view>
      <view class="header-btn-wrap">
        <button class="hero-btn" size="mini" bindtap="goToPublish">å‘å¸ƒæ´»åŠ¨</button>
      </view>
    </view>

    <scroll-view class="scroll-list" scroll-y enable-back-to-top show-scrollbar="{{false}}" style="height: {{scrollListHeight}}px;">
      <view wx:if="{{!displayList.length}}" class="empty-block">
        <text class="empty-text">{{selectedAlumniAssociationId ? 'æš‚æ— åŒ¹é…çš„æ´»åŠ¨ï¼Œæ¢ä¸ªæ¡ä»¶è¯•è¯•' : 'è¯·å…ˆé€‰æ‹©æ ¡å‹ä¼š'}}</text>
      </view>

      <view class="activity-list" wx:else>
        <view
          class="activity-card"
          wx:for="{{displayList}}"
          wx:key="id"
          bindtap="viewDetail"
          data-id="{{item.id}}"
        >
          <view class="activity-header">
            <view class="activity-title">{{item.title}}</view>
            <view class="status-badge {{item.status}}">
              {{item.originalStatus === 0 ? 'è‰ç¨¿' : item.originalStatus === 1 ? 'æŠ¥åä¸­' : item.originalStatus === 2 ? 'æŠ¥åç»“æŸ' : item.originalStatus === 3 ? 'è¿›è¡Œä¸­' : item.originalStatus === 4 ? 'å·²ç»“æŸ' : item.originalStatus === 5 ? 'å·²å–æ¶ˆ' : 'å³å°†å¼€å§‹'}}
            </view>
          </view>
          <view class="activity-meta">
            <text>{{item.organizer}}</text>
            <text class="dot">Â·</text>
            <text>{{item.participantCount}}äººå·²æŠ¥</text>
          </view>
          <view class="activity-tags" wx:if="{{item.tags.length > 0}}">
            <view class="tag" wx:for="{{item.tags}}" wx:key="*this">{{item}}</view>
          </view>
          <view class="activity-footer">
            <text wx:if="{{item.location}}">ğŸ“ {{item.location}}</text>
            <text class="time">ğŸ• {{item.startTime}}</text>
          </view>
          <view class="activity-actions">
            <view class="edit-btn" catchtap="editActivity" data-id="{{item.id}}">ç¼–è¾‘</view>
            <view class="delete-btn" catchtap="deleteActivity" data-id="{{item.id}}">åˆ é™¤</view>
          </view>
        </view>
      </view>
    </scroll-view>
  </view>

  <!-- æ ¡å‹ä¼šé€‰æ‹©å™¨å¼¹çª— -->
  <view class="alumni-association-picker" wx:if="{{showAlumniAssociationPicker}}">
    <view class="picker-overlay" bindtap="cancelAlumniAssociationSelect"></view>
    <view class="picker-content">
      <view class="picker-header">
        <text class="picker-title">é€‰æ‹©æ ¡å‹ä¼š</text>
        <text class="picker-cancel" bindtap="cancelAlumniAssociationSelect">å–æ¶ˆ</text>
      </view>
      <view class="picker-list">
        <view
          class="picker-item"
          wx:for="{{alumniAssociationList}}"
          wx:key="alumniAssociationId"
          data-alumni-association-id="{{item.alumniAssociationId}}"
          data-alumni-association-name="{{item.alumniAssociationName}}"
          bindtap="selectAlumniAssociation"
        >
          <text class="item-name">{{item.alumniAssociationName}}</text>
          <text class="item-check" wx:if="{{selectedAlumniAssociationId == item.alumniAssociationId}}">âœ“</text>
        </view>
        <view class="picker-empty" wx:if="{{alumniAssociationList.length === 0}}">
          <text>æš‚æ— æ ¡å‹ä¼šæ•°æ®</text>
        </view>
      </view>
    </view>
  </view>
</view>
</custom-nav-bar>
