<!--pages/chat/list/list.wxml-->
<view class="chat-page">
  <!-- èœå•æ  -->
  <view class="menu-bar">
    <view class="menu-btn" bindtap="toggleSidebar">
      <text class="menu-icon">â˜°</text>
      <text class="menu-text">èœå•</text>
    </view>
  </view>

  <!-- ä¾§è¾¹æ é®ç½© -->
  <view class="sidebar-mask {{showSidebar ? 'show' : ''}}" bindtap="toggleSidebar"></view>

  <!-- ä¾§è¾¹æ  -->
  <view class="sidebar {{showSidebar ? 'show' : ''}}">
    <view class="sidebar-header">
      <text class="sidebar-title">èœå•</text>
      <text class="sidebar-close" bindtap="toggleSidebar">Ã—</text>
    </view>
    <view class="sidebar-content">
      <view class="sidebar-item" bindtap="navigateToMyAssociations">
        <text class="sidebar-icon">ğŸ‘¥</text>
        <text class="sidebar-text">æˆ‘åŠ å…¥çš„æ ¡å‹ä¼š</text>
        <text class="sidebar-arrow">â€º</text>
      </view>
      <view class="sidebar-item" bindtap="navigateToMyFollows">
        <text class="sidebar-icon">â¤ï¸</text>
        <text class="sidebar-text">æˆ‘å…³æ³¨çš„</text>
        <text class="sidebar-arrow">â€º</text>
      </view>
      <view class="sidebar-item" bindtap="navigateToMyFavorites">
        <text class="sidebar-icon">â­</text>
        <text class="sidebar-text">æˆ‘æ”¶è—çš„</text>
        <text class="sidebar-arrow">â€º</text>
      </view>
    </view>
  </view>

  <!-- èŠå¤©åˆ—è¡¨ -->
  <scroll-view class="chat-list" scroll-y refresher-enabled="{{true}}" refresher-triggered="{{refreshing}}" bindrefresherrefresh="onRefresh">
    <!-- æ‰€æœ‰èŠå¤©ï¼ˆåŒ…æ‹¬æ ¡å‹ä¼šé€šçŸ¥ï¼‰ -->
    <view class="chat-item" wx:for="{{allChatList}}" wx:key="id" bindtap="openChat" data-id="{{item.id}}" data-peerid="{{item.peerId}}" data-type="{{item.type || 'chat'}}">
      <view class="chat-avatar-wrapper">
        <image class="chat-avatar" src="{{item.avatar}}" mode="aspectFill"></image>
        <view class="online-status" wx:if="{{item.isOnline}}"></view>
        <view class="oa-badge" wx:if="{{item.isVerified}}">âœ“</view>
        <view class="unread-badge" wx:if="{{item.unreadCount > 0}}">{{item.unreadCount > 99 ? '99+' : item.unreadCount}}</view>
      </view>
      <view class="chat-content">
        <view class="chat-header">
          <text class="chat-name">{{item.name}}</text>
          <text class="chat-time">{{item.lastTime}}</text>
        </view>
        <view class="chat-preview">
          <text class="chat-message">{{item.lastMessage}}</text>
          <view class="chat-mute" wx:if="{{item.isMuted}}">ğŸ”‡</view>
        </view>
      </view>
    </view>
    
    <view class="empty-state" wx:if="{{chatList.length === 0 && !loading}}">
      <text class="empty-text">æš‚æ— èŠå¤©è®°å½•</text>
    </view>
  </scroll-view>
</view>

