<!--pages/school/detail/detail.wxml-->
<view class="container">
  <view wx:if="{{loading}}" class="loading-wrap">
    <view class="loading">加载中...</view>
  </view>

  <view wx:else>
    <!-- 封面图 -->
    <view class="cover-section">
      <image class="cover-image" src="{{schoolInfo.cover}}" mode="aspectFill" bindtap="previewImage" data-url="{{schoolInfo.cover}}" />
      <view class="cover-overlay">
        <view class="school-basic">
          <image class="school-icon-large" src="{{schoolInfo.icon}}" mode="aspectFill" />
          <view class="school-basic-info">
            <view class="school-name-row">
              <text class="school-name-large">{{schoolInfo.name}}</text>
              <view wx:if="{{schoolInfo.isCertified}}" class="certified-badge-large">✓</view>
            </view>
            <view class="school-location-large">📍 {{schoolInfo.location}}</view>
          </view>
        </view>
      </view>
    </view>

    <!-- 操作按钮 -->
    <view class="action-bar">
      <view class="action-btn" bindtap="toggleFollow">
        <text class="action-icon">{{schoolInfo.isFollowed ? '★' : '☆'}}</text>
        <text class="action-text">{{schoolInfo.isFollowed ? '已关注' : '关注'}}</text>
      </view>
      <view class="action-btn" bindtap="makeCall">
        <text class="action-icon">📞</text>
        <text class="action-text">电话</text>
      </view>
      <view class="action-btn" button open-type="share">
        <text class="action-icon">🔗</text>
        <text class="action-text">分享</text>
      </view>
    </view>

    <!-- 选项卡 -->
    <view class="tabs">
      <view class="tab-item {{activeTab === index ? 'active' : ''}}" wx:for="{{tabs}}" wx:key="*this" bindtap="switchTab" data-index="{{index}}">
        {{item}}
      </view>
    </view>

    <!-- 基本信息 -->
    <view wx:if="{{activeTab === 0}}" class="tab-content">
      <view class="info-section card">
        <view class="section-title-small">基本信息</view>

        <view class="info-row">
          <view class="info-label">学校名称</view>
          <view class="info-value">{{schoolInfo.name}}</view>
        </view>

        <view wx:if="{{schoolInfo.oldNames && schoolInfo.oldNames.length > 0}}" class="info-row">
          <view class="info-label">曾用名</view>
          <view class="info-value">{{schoolInfo.oldNames.join('、')}}</view>
        </view>

        <view class="info-row">
          <view class="info-label">创建年份</view>
          <view class="info-value">{{schoolInfo.foundedYear}}年</view>
        </view>

        <view class="info-row">
          <view class="info-label">所在地</view>
          <view class="info-value">{{schoolInfo.location}}</view>
        </view>

        <view class="info-row">
          <view class="info-label">标签</view>
          <view class="info-value">
            <text class="tag" wx:for="{{schoolInfo.tags}}" wx:key="*this" wx:for-item="tag">{{tag}}</text>
          </view>
        </view>

        <view class="info-row">
          <view class="info-label">校友数量</view>
          <view class="info-value theme-color">{{schoolInfo.alumniCount}}人</view>
        </view>

        <view class="info-row">
          <view class="info-label">校友会数量</view>
          <view class="info-value theme-color">{{schoolInfo.associationCount}}个</view>
        </view>

        <view class="info-row">
          <view class="info-label">官方网站</view>
          <view class="info-value link-text" bindtap="copyWebsite">{{schoolInfo.website}}</view>
        </view>

        <view class="info-row">
          <view class="info-label">联系电话</view>
          <view class="info-value link-text" bindtap="makeCall">{{schoolInfo.phone}}</view>
        </view>
      </view>

      <view class="info-section card">
        <view class="section-title-small">学校简介</view>
        <view class="description-text">{{schoolInfo.description}}</view>
      </view>
    </view>

    <!-- 校友总会 -->
    <view wx:if="{{activeTab === 1}}" class="tab-content">
      <view class="union-section card" wx:if="{{alumniUnion}}" bindtap="viewAlumniUnion">
        <view class="union-header">
          <image class="union-icon" src="{{alumniUnion.icon}}" mode="aspectFill" />
          <view class="union-info">
            <view class="union-name-row">
              <text class="union-name">{{alumniUnion.name}}</text>
              <view wx:if="{{alumniUnion.isCertified}}" class="certified-badge">✓ 认证主体</view>
            </view>
            <view class="union-desc">{{alumniUnion.description}}</view>
          </view>
        </view>

        <view class="union-contact">
          <view class="contact-item">
            <text class="contact-label">官方网站：</text>
            <text class="contact-value">{{alumniUnion.website}}</text>
          </view>
          <view class="contact-item">
            <text class="contact-label">联系电话：</text>
            <text class="contact-value">{{alumniUnion.phone}}</text>
          </view>
          <view class="contact-item">
            <text class="contact-label">电子邮箱：</text>
            <text class="contact-value">{{alumniUnion.email}}</text>
          </view>
          <view class="contact-item">
            <text class="contact-label">微信公众号：</text>
            <text class="contact-value">{{alumniUnion.wechat}}</text>
          </view>
        </view>

        <view wx:if="{{alumniUnion.hasApp}}" class="union-tip">
          <text class="tip-icon">💡</text>
          <text class="tip-text">点击可跳转到校友总会小程序</text>
        </view>
      </view>

      <view wx:else class="empty-state">
        <image src="https://via.placeholder.com/200/f0f0f0/999999?text=Empty" mode="aspectFill" />
        <text>暂无校友总会信息</text>
      </view>
    </view>
  </view>
</view>
