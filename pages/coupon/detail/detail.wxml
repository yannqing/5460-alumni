<!--pages/coupon/detail/detail.wxml-->
<view class="coupon-detail-page">
  <!-- åŠ è½½ä¸­ -->
  <view wx:if="{{loading}}" class="loading-container">
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>

  <view wx:elif="{{couponInfo}}">
    <!-- æ ¸é”€äºŒç»´ç å¡ç‰‡ -->
    <view class="coupon-card-large">
      <view class="qr-code-container">
        <view class="qr-code-wrapper">
          <image 
            wx:if="{{qrCodeImage}}" 
            class="qr-code-image" 
            src="{{qrCodeImage}}" 
            mode="aspectFit"
          ></image>
          <view wx:else class="qr-code-placeholder">
            <text class="placeholder-text">äºŒç»´ç åŠ è½½ä¸­...</text>
          </view>
        </view>
        <view class="refresh-btn-wrapper">
          <view class="refresh-btn" bindtap="refreshCode">
            <text class="refresh-icon">ğŸ”„</text>
            <text class="refresh-text">åˆ·æ–°</text>
          </view>
        </view>
      </view>
      <view class="coupon-card-divider"></view>
      <view class="coupon-card-right">
        <view class="coupon-title-detail">{{couponInfo.couponName}}</view>
        <view class="coupon-code-display">
          <text class="code-label">æ ¸é”€ç ï¼š</text>
          <text class="code-value">{{couponInfo.verificationCode || 'æš‚æ— '}}</text>
        </view>
        <view class="coupon-validity">
          <text>æœ‰æ•ˆæœŸè‡³ {{couponInfo.validEndTime}}</text>
        </view>
        <view class="coupon-status" wx:if="{{couponInfo.status}}">
          <text class="status-text status-{{couponInfo.status}}">
            {{couponInfo.status === 1 ? 'æœªä½¿ç”¨' : couponInfo.status === 2 ? 'å·²ä½¿ç”¨' : couponInfo.status === 3 ? 'å·²è¿‡æœŸ' : 'å·²ä½œåºŸ'}}
          </text>
        </view>
      </view>
    </view>

    <view class="card">
      <view class="text-bold mb-20">ä¼˜æƒ åˆ¸ä¿¡æ¯</view>
      <view class="info-row">
        <text class="info-label">ä¼˜æƒ åˆ¸ç±»å‹ï¼š</text>
        <text class="info-value">
          {{couponInfo.couponType === 1 ? 'æŠ˜æ‰£åˆ¸' : couponInfo.couponType === 2 ? 'æ»¡å‡åˆ¸' : couponInfo.couponType === 3 ? 'ç¤¼å“åˆ¸' : 'æœªçŸ¥'}}
        </text>
      </view>
      <view class="info-row" wx:if="{{couponInfo.discountValue}}">
        <text class="info-label">ä¼˜æƒ å€¼ï¼š</text>
        <text class="info-value">{{couponInfo.discountValue}}</text>
      </view>
      <view class="info-row" wx:if="{{couponInfo.minSpend}}">
        <text class="info-label">æœ€ä½æ¶ˆè´¹ï¼š</text>
        <text class="info-value">Â¥{{couponInfo.minSpend}}</text>
      </view>
      <view class="divider"></view>
      <view class="text-bold mb-20">æœ‰æ•ˆæœŸ</view>
      <view class="text-secondary">
        {{couponInfo.validStartTime}} è‡³ {{couponInfo.validEndTime}}
      </view>
      <view class="info-row" wx:if="{{couponInfo.verificationExpireTime}}">
        <text class="info-label">æ ¸é”€ç è¿‡æœŸæ—¶é—´ï¼š</text>
        <text class="info-value">{{couponInfo.verificationExpireTime}}</text>
      </view>
    </view>
  </view>
</view>
