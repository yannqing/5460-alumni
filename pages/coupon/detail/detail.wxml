<!--pages/coupon/detail/detail.wxml-->
<view class="coupon-detail-page">
  <view wx:if="{{couponInfo}}">
    <!-- 优惠券卡片 -->
    <view class="coupon-card-large">
      <view class="coupon-card-left">
        <view class="coupon-discount-large">
          <text wx:if="{{couponInfo.discountPrice > 0}}">¥{{couponInfo.discountPrice}}</text>
          <text wx:else>{{couponInfo.discount || '优惠券'}}</text>
        </view>
        <view class="coupon-label-large">优惠券</view>
        <view class="coupon-original-price" wx:if="{{couponInfo.originalPrice > 0}}">
          原价¥{{couponInfo.originalPrice}}
        </view>
      </view>
      <view class="coupon-card-divider"></view>
      <view class="coupon-card-right">
        <view class="coupon-title-detail">{{couponInfo.title}}</view>
        <view class="coupon-merchant-detail">{{couponInfo.merchant}}</view>
        <view class="coupon-validity">
          <text>有效期至 {{couponInfo.endTime}}</text>
        </view>
        <view class="coupon-stock-info">
          <text>剩余{{couponInfo.stock}}/{{couponInfo.totalStock}}</text>
        </view>
      </view>
    </view>

    <!-- 操作按钮 -->
    <view class="action-section">
      <view class="btn btn-primary full-width" bindtap="handleCoupon">
        {{couponInfo.type === 'rush' ? '立即抢购' : '立即领取'}}
      </view>
    </view>

    <view class="card">
      <view class="text-bold mb-20">优惠券说明</view>
      <view class="text-secondary">{{couponInfo.description}}</view>

      <view class="divider"></view>

      <view class="text-bold mb-20">使用规则</view>
      <view class="rule-list">
        <view class="rule-item" wx:for="{{couponInfo.rules}}" wx:key="*this">
          <text class="rule-dot">•</text>
          <text class="rule-text">{{item}}</text>
        </view>
      </view>

      <view class="divider"></view>

      <view class="text-bold mb-20">有效期</view>
      <view class="text-secondary">{{couponInfo.startTime}} 至 {{couponInfo.endTime}}</view>
    </view>

    <view class="card">
      <view class="text-bold mb-20">商家信息</view>
      <view class="merchant-info-row">
        <text class="info-label">名称：</text>
        <text class="info-value">{{couponInfo.merchant}}</text>
      </view>
      <view class="merchant-info-row">
        <text class="info-label">地址：</text>
        <text class="info-value">{{couponInfo.merchantAddress}}</text>
      </view>
      <view class="merchant-info-row">
        <text class="info-label">电话：</text>
        <text class="info-value link-text" bindtap="callMerchant">{{couponInfo.merchantPhone}}</text>
      </view>
    </view>
  </view>
</view>
