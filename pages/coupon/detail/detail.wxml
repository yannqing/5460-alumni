<!--pages/coupon/detail/detail.wxml-->
<view class="container">
  <view wx:if="{{couponInfo}}">
    <image class="cover-image" src="{{couponInfo.image}}" mode="aspectFill" />

    <view class="card">
      <view class="coupon-header">
        <view class="flex-1">
          <view class="coupon-title-large">{{couponInfo.title}}</view>
          <view class="coupon-merchant-large">{{couponInfo.merchant}}</view>
          <view class="coupon-price-large">
            <text class="price-now-large">¥{{couponInfo.discountPrice}}</text>
            <text wx:if="{{couponInfo.originalPrice > 0}}" class="price-original-large">¥{{couponInfo.originalPrice}}</text>
          </view>
        </view>
      </view>

      <view class="divider"></view>

      <view class="coupon-stock-section">
        <view class="stock-info">
          <text>剩余：{{couponInfo.stock}}/{{couponInfo.totalStock}}</text>
        </view>
        <view class="stock-bar-large">
          <view class="stock-progress" style="width: {{couponInfo.stock/couponInfo.totalStock*100}}%"></view>
        </view>
      </view>

      <view class="btn btn-primary full-width" bindtap="handleCoupon">
        {{couponInfo.type === 'rush' ? '立即抢购' : '立即领取'}}
      </view>
    </view>

    <view class="card">
      <view class="text-bold mb-20">优惠券说明</view>
      <view class="text-secondary">{{couponInfo.description}}</view>

      <view class="divider"></view>

      <view class="text-bold mb-20">使用规则</view>
      <view class="rule-list">
        <view class="rule-item" wx:for="{{couponInfo.rules}}" wx:key="*this">
          <text class="rule-dot">•</text>
          <text class="rule-text">{{item}}</text>
        </view>
      </view>

      <view class="divider"></view>

      <view class="text-bold mb-20">有效期</view>
      <view class="text-secondary">{{couponInfo.startTime}} 至 {{couponInfo.endTime}}</view>
    </view>

    <view class="card">
      <view class="text-bold mb-20">商家信息</view>
      <view class="merchant-info-row">
        <text class="info-label">名称：</text>
        <text class="info-value">{{couponInfo.merchant}}</text>
      </view>
      <view class="merchant-info-row">
        <text class="info-label">地址：</text>
        <text class="info-value">{{couponInfo.merchantAddress}}</text>
      </view>
      <view class="merchant-info-row">
        <text class="info-label">电话：</text>
        <text class="info-value link-text" bindtap="callMerchant">{{couponInfo.merchantPhone}}</text>
      </view>
    </view>
  </view>
</view>
