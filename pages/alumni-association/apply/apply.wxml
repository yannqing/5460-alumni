<!--pages/alumni-association/apply/apply.wxml-->
<view class="container">
  <view class="form-container">
    <view class="form-header">
      <view class="form-title">申请加入校友会</view>
      <view class="form-subtitle">请填写以下信息，提交后等待审核</view>
    </view>

    <!-- 基本信息 -->
    <view class="form-section">
      <view class="section-title">基本信息</view>

      <view class="form-item required">
        <view class="form-label">真实姓名</view>
        <input
          class="form-input"
          placeholder="请输入真实姓名"
          value="{{formData.name}}"
          bindinput="handleInput"
          data-field="name"
          maxlength="20"
        />
      </view>

      <view class="form-item required">
        <view class="form-label">身份证号</view>
        <input
          class="form-input"
          placeholder="请输入身份证号"
          value="{{formData.identifyCode}}"
          bindinput="handleInput"
          data-field="identifyCode"
          maxlength="18"
        />
      </view>

      <view class="form-item">
        <view class="form-label">手机号</view>
        <input
          class="form-input"
          type="number"
          placeholder="请输入手机号"
          value="{{formData.phone}}"
          bindinput="handleInput"
          data-field="phone"
          maxlength="11"
        />
      </view>

      <view class="form-item">
        <view class="form-label">申请理由</view>
        <textarea
          class="form-textarea"
          placeholder="请简要说明申请理由（选填）"
          value="{{formData.applicationReason}}"
          bindinput="handleInput"
          data-field="applicationReason"
          maxlength="200"
        />
      </view>
    </view>

    <!-- 教育经历 -->
    <view class="form-section">
      <view class="section-title">教育经历（选填）</view>

      <view wx:if="{{schoolName}}" class="form-item">
        <view class="form-label">学校</view>
        <view class="form-display">{{schoolName}}</view>
      </view>

      <view class="form-item">
        <view class="form-label">入学年份</view>
        <picker
          mode="date"
          fields="year"
          value="{{formData.enrollmentYear}}"
          bindchange="handleYearChange"
          data-field="enrollmentYear"
        >
          <view class="form-picker">
            {{formData.enrollmentYear || '请选择入学年份'}}
          </view>
        </picker>
      </view>

      <view class="form-item">
        <view class="form-label">毕业年份</view>
        <picker
          mode="date"
          fields="year"
          value="{{formData.graduationYear}}"
          bindchange="handleYearChange"
          data-field="graduationYear"
        >
          <view class="form-picker">
            {{formData.graduationYear || '请选择毕业年份'}}
          </view>
        </picker>
      </view>

      <view class="form-item">
        <view class="form-label">院系</view>
        <input
          class="form-input"
          placeholder="请输入院系"
          value="{{formData.department}}"
          bindinput="handleInput"
          data-field="department"
          maxlength="50"
        />
      </view>

      <view class="form-item">
        <view class="form-label">专业</view>
        <input
          class="form-input"
          placeholder="请输入专业"
          value="{{formData.major}}"
          bindinput="handleInput"
          data-field="major"
          maxlength="50"
        />
      </view>

      <view class="form-item">
        <view class="form-label">班级</view>
        <input
          class="form-input"
          placeholder="请输入班级"
          value="{{formData.className}}"
          bindinput="handleInput"
          data-field="className"
          maxlength="50"
        />
      </view>

      <view class="form-item">
        <view class="form-label">学历层次</view>
        <picker
          mode="selector"
          range="{{educationLevels}}"
          value="{{educationLevelIndex}}"
          bindchange="handleEducationLevelChange"
        >
          <view class="form-picker">
            {{formData.educationLevel || '请选择学历层次'}}
          </view>
        </picker>
      </view>
    </view>

    <!-- 附件上传 -->
    <view class="form-section">
      <view class="section-title">相关材料（选填）</view>
      <view class="upload-container">
        <block wx:for="{{attachments}}" wx:key="index">
          <view class="upload-item">
            <image class="upload-image" src="{{item.url}}" mode="aspectFill" />
            <view class="upload-delete" bindtap="deleteAttachment" data-index="{{index}}">×</view>
          </view>
        </block>
        <view wx:if="{{attachments.length < 3}}" class="upload-button" bindtap="chooseImage">
          <text class="upload-icon">+</text>
          <text class="upload-text">上传图片</text>
        </view>
      </view>
      <view class="upload-hint">最多上传3张图片</view>
    </view>

    <!-- 提交按钮 -->
    <view class="form-actions">
      <button class="submit-button" bindtap="submitApplication" disabled="{{submitting}}">
        {{submitting ? '提交中...' : '提交申请'}}
      </button>
    </view>
  </view>
</view>
