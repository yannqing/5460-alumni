<!--pages/alumni-association/organization/organization.wxml-->
<view class="container">
  <view class="form-card">
    <view class="form-title">校友会组织</view>

    <!-- 选择校友会 -->
    <view class="form-item">
      <text class="label">选择校友会</text>
      <view class="alumni-association-selector" bindtap="showAlumniAssociationSelector">
        <text class="selector-label">{{selectedAlumniAssociationName || '请选择校友会'}}</text>
        <text class="selector-arrow">▼</text>
      </view>
    </view>
  </view>

  <!-- 角色列表 -->
  <view class="form-card" style="margin-top: 20rpx;">
    <view class="form-title">校友会角色列表</view>
    
    <!-- 加载中 -->
    <view wx:if="{{roleLoading}}" class="loading-state">
      <text>加载角色中...</text>
    </view>
    
    <!-- 角色列表 -->
    <view class="role-list" wx:else>
      <view class="role-item" wx:for="{{roleList}}" wx:key="roleOrId">
        <view class="role-name">{{item.roleOrName}}</view>
        <view class="delete-btn" bindtap="deleteRole" data-role-or-id="{{item.roleOrId}}">删除</view>
      </view>
      
      <!-- 空状态 -->
      <view class="empty-state" wx:if="{{roleList.length === 0}}">
        <text>{{selectedAlumniAssociationId ? '暂无角色数据' : '请先选择校友会'}}</text>
      </view>
    </view>
  </view>

  <!-- 校友会选择器弹窗 -->
  <view class="alumni-association-picker" wx:if="{{showAlumniAssociationPicker}}">
    <view class="picker-overlay" bindtap="cancelAlumniAssociationSelect"></view>
    <view class="picker-content">
      <view class="picker-header">
        <text class="picker-title">选择校友会</text>
        <text class="picker-cancel" bindtap="cancelAlumniAssociationSelect">取消</text>
      </view>
      <view class="picker-list">
        <view 
          class="picker-item"
          wx:for="{{alumniAssociationList}}"
          wx:key="alumniAssociationId"
          data-alumni-association-id="{{item.alumniAssociationId}}"
          data-alumni-association-name="{{item.alumniAssociationName}}"
          bindtap="selectAlumniAssociation"
        >
          <text class="item-name">{{item.alumniAssociationName}}</text>
          <text class="item-check" wx:if="{{selectedAlumniAssociationId == item.alumniAssociationId}}">✓</text>
        </view>
        <view class="picker-empty" wx:if="{{alumniAssociationList.length === 0}}">
          <text>暂无校友会数据</text>
        </view>
      </view>
    </view>
  </view>
</view>