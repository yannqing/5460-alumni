<!--pages/alumni-association/detail/detail.wxml-->
<view class="container">
  <view wx:if="{{associationInfo}}">
    <image class="cover-image" src="{{associationInfo.cover}}" mode="aspectFill" />

    <view class="card">
      <view class="flex">
        <image class="avatar-large" src="{{associationInfo.icon}}" mode="aspectFill" />
        <view class="flex-1 ml-20">
          <view class="text-primary text-bold">{{associationInfo.name}}</view>
          <view class="text-secondary mt-10">{{associationInfo.schoolName}}</view>
          <view class="text-placeholder mt-10">ğŸ“ {{associationInfo.location}}</view>
        </view>
      </view>
      <view class="mt-20">
        <view class="btn btn-primary full-width" bindtap="toggleJoin">
          {{associationInfo.isJoined ? 'é€€å‡ºæ ¡å‹ä¼š' : 'åŠ å…¥æ ¡å‹ä¼š'}}
        </view>
      </view>
    </view>

    <view class="tabs">
      <view class="tab-item {{activeTab === index ? 'active' : ''}}" wx:for="{{tabs}}" wx:key="*this" bindtap="switchTab" data-index="{{index}}">
        {{item}}
      </view>
    </view>

    <view wx:if="{{activeTab === 0}}" class="tab-content">
      <view class="card">
        <view class="text-bold mb-20">åŸºæœ¬ä¿¡æ¯</view>
        <view class="text-secondary">{{associationInfo.description}}</view>
        <view class="divider"></view>
        <view class="text-secondary">ä¼šé•¿ï¼š{{associationInfo.president}}</view>
        <view class="text-secondary mt-10">æˆå‘˜ï¼š{{associationInfo.memberCount}}äºº</view>
        <view class="text-secondary mt-10">æˆç«‹äºï¼š{{associationInfo.establishedYear}}å¹´</view>
      </view>

      <!-- é€šçŸ¥åˆ—è¡¨ -->
      <view class="card mt-20">
        <view class="section-header">
          <view class="text-bold">é€šçŸ¥</view>
          <view class="text-placeholder" bindtap="viewNotificationDetail" data-id="all">æŸ¥çœ‹æ›´å¤š</view>
        </view>
        <view class="list-item" wx:for="{{notifications}}" wx:key="id" bindtap="viewNotificationDetail" data-id="{{item.id}}">
          <view class="flex-1">
            <view class="text-primary">{{item.title}}</view>
            <view class="text-placeholder mt-10">{{item.content}}</view>
            <view class="text-placeholder mt-10" style="font-size: 22rpx;">{{item.time}}</view>
          </view>
          <view wx:if="{{!item.isRead}}" class="notification-dot-small"></view>
        </view>
      </view>

      <!-- æ´»åŠ¨åˆ—è¡¨ -->
      <view class="card mt-20">
        <view class="section-header">
          <view class="text-bold">æ´»åŠ¨</view>
          <view class="text-placeholder" bindtap="viewActivityDetail" data-id="all">æŸ¥çœ‹æ›´å¤š</view>
        </view>
        <view class="list-item" wx:for="{{benefitActivities}}" wx:key="id" bindtap="viewActivityDetail" data-id="{{item.id}}">
          <view class="flex-1">
            <view class="text-primary">{{item.title}}</view>
            <view class="text-placeholder mt-10">ğŸ“ {{item.location}}</view>
            <view class="text-placeholder mt-10" style="font-size: 22rpx;">ğŸ• {{item.time}} Â· {{item.participantCount}}äººæŠ¥å</view>
          </view>
        </view>
      </view>

      <!-- é™„è¿‘æƒç›Šåˆ—è¡¨ -->
      <view class="card mt-20">
        <view class="section-header">
          <view class="text-bold">é™„è¿‘æƒç›Š</view>
          <view class="text-placeholder" bindtap="viewBenefitDetail" data-id="all">æŸ¥çœ‹æ›´å¤š</view>
        </view>
        <view class="list-item" wx:for="{{nearbyBenefits}}" wx:key="id" bindtap="viewBenefitDetail" data-id="{{item.id}}">
          <view class="flex-1">
            <view class="text-primary">
              {{item.title}}
              <view wx:if="{{item.isNew}}" class="new-badge-inline">ä¸Šæ–°</view>
            </view>
            <view class="text-placeholder mt-10">{{item.merchant}} Â· {{item.discount}} Â· è·ç¦»{{item.distance}}</view>
          </view>
        </view>
      </view>
    </view>

    <view wx:if="{{activeTab === 1}}">
      <view class="list-item" wx:for="{{members}}" wx:key="id">
        <image class="avatar" src="{{item.avatar}}" mode="aspectFill" />
        <view class="flex-1">
          <view class="text-primary">{{item.name}}</view>
          <view class="text-placeholder mt-10">{{item.role}} Â· {{item.company}}</view>
        </view>
      </view>
    </view>

    <view wx:if="{{activeTab === 2}}">
      <view class="card" wx:if="{{associationUnion}}">
        <view class="text-bold mb-20">æ ¡å‹æ€»ä¼š</view>
        <view class="flex mb-20">
          <image class="avatar-large" src="{{associationUnion.icon}}" mode="aspectFill" />
          <view class="flex-1 ml-20">
            <view class="text-primary text-bold">{{associationUnion.name}}</view>
            <view class="text-secondary mt-10">{{associationUnion.address}}</view>
          </view>
        </view>
        <view class="text-secondary">{{associationUnion.description}}</view>
        <view class="divider"></view>
        <view class="text-secondary mt-10">å®˜ç½‘ï¼š{{associationUnion.website}}</view>
        <view class="text-secondary mt-10">ç”µè¯ï¼š{{associationUnion.phone}}</view>
        <view class="text-secondary mt-10">é‚®ç®±ï¼š{{associationUnion.email}}</view>
      </view>
      <view wx:else class="empty-state">
        <image src="https://via.placeholder.com/200/f0f0f0/999999?text=Empty" mode="aspectFill" />
        <text>æš‚æ— æ ¡å‹æ€»ä¼šä¿¡æ¯</text>
      </view>
    </view>
  </view>
</view>
